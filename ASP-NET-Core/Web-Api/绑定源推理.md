`[ApiController]` 的另一个“隐形福利”：**绑定源推理**  
——框架会根据**参数类型**和**C# 签名**，**自动**帮你加上 `[FromQuery]`、`[FromBody]`、`[FromRoute]` 等特性，**无需**再手写。

---

### 1. 推理规则（ASP.NET Core 3.0+）

| 参数场景 | 默认绑定源 | 等价于手写 |
|-----------|-------------|--------------|
| **复杂类型**（POCO、DTO、record） | `[FromBody]` | `([FromBody] MyDto dto)` |
| **值类型 / string** 且 **GET/HEAD** 请求 | `[FromQuery]` | `([FromQuery] int page)` |
| **值类型 / string** 且 **POST/PUT** 请求 | `[FromForm]` | `([FromForm] string name)` |
| **与路由模板同名** 的参数 | `[FromRoute]` | `([FromRoute] int id)` |
| **特殊类型**（`IFormFile`、`IFormCollection`、`CancellationToken`、`HttpContext` 等） | 按专用绑定器处理 | 无需干预 |

---

### 2. 代码示例

```csharp
[ApiController]
[Route("api/[controller]")]
public class ProductsController : ControllerBase
{
    // 1. 复杂类型 => [FromBody] 自动加上
    [HttpPost]
    public IActionResult Create(ProductDto dto)   // 等价于 ([FromBody] ProductDto dto)
        => Ok(dto);

    // 2. 与路由段同名 => [FromRoute]
    [HttpGet("{id:int}")]
    public IActionResult Get(int id)              // 等价于 ([FromRoute] int id)
        => Ok(new { id });

    // 3. 简单类型，GET 请求 => [FromQuery]
    [HttpGet]
    public IActionResult List(int page, int size) // 等价于 ([FromQuery] int page, [FromQuery] int size)
        => Ok(new { page, size });

    // 4. IFormFile => 自动按 [FromForm] 处理
    [HttpPost("upload")]
    public IActionResult Upload(IFormFile file)   // 无需标注
        => Ok(file.FileName);
}
```

---

### 3. 何时需要手动写？

- **想换绑定源**  
  例如把复杂对象也拆开从查询字符串读：

  ```csharp
  [HttpGet("search")]
  public IActionResult Search([FromQuery] SearchDto dto) { … }
  ```

- **一个 Action 里有多个复杂参数**  
  框架只能默认给**第一个**加 `[FromBody]`，其余必须手写：

  ```csharp
  [HttpPut("full")]
  public IActionResult FullUpdate(
      [FromBody] HeaderDto header,
      [FromBody] DetailDto detail)   // 第二个必须显式
  ```

- **自定义模型绑定器** / 自定义值提供器

---

### 4. 关闭推理（不推荐，但可做到）

```csharp
services.AddControllers()
        .ConfigureApiBehaviorOptions(opt =>
        {
            opt.SuppressInferBindingSourcesForParameters = true;
        });
```

关闭后，**所有参数都视为 `[FromQuery]`**，除非你自己贴特性。

---

### ✅ 一句话总结

`[ApiController]` 会“**读心术**”：  
复杂对象 = body，简单参数 = query/route，文件 = form；  
**90% 场景**不用再写 `[FromXxx]`，**不到必要时别关推理**。