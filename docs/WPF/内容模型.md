---
title: "WPF 内容模型"
excerpt_separator: "<!--more-->"
categories:
  - ContentControl
  - ContentPresenter
tags:
---

[微软官网](https://learn.microsoft.com/zh-cn/dotnet/desktop/wpf/controls/wpf-content-model)
[ContentPresenter 类](https://learn.microsoft.com/zh-cn/dotnet/api/system.windows.controls.contentpresenter?view=windowsdesktop-9.0)显示 ContentControl 的内容。

在 WPF（Windows Presentation Foundation）中，ContentPresenter 和 ContentControl 是两个密切相关但职责完全不同的类。理解它们的区别对于掌握 WPF 的控件模板和内容呈现机制至关重要。

简单来说：

ContentControl 是一个控件 (Control)，它可以包含并显示单个内容。
ContentPresenter 是一个元素 (Element)，它的作用是在 ContentControl 的模板中呈现其内容。

下面详细解释它们的区别：

### 定义与角色

ContentControl
角色：它是一个用户界面控件（继承自 Control），是许多 WPF 控件的基础，如 Button, CheckBox, ScrollViewer 等。
功能：ContentControl 负责管理其“内容”（通过 Content 属性设置）。这个内容可以是任何对象，比如字符串、UIElement、自定义对象等。
关键属性：
Content: 存储要显示的内容。
ContentTemplate: 指定如何将内容数据转换为 UI 的 DataTemplate。
ContentTemplateSelector: 允许根据内容选择不同模板的模板选择器。
ContentStringFormat: 格式化内容为字符串时使用的格式。
核心任务：管理内容数据，并提供一种机制来决定内容应该如何被可视化。

ContentPresenter
角色：它是一个轻量级的布局元素（继承自 FrameworkElement），专门用于在视觉树中呈现由 ContentControl 或其他类似容器提供的内容。
功能：它不管理内容本身，而是读取 ContentControl 的 Content, ContentTemplate 等属性，并根据这些信息创建实际的 UI 元素并将其添加到视觉树中。
使用场景：通常出现在 ContentControl 的 ControlTemplate 内部。当你为一个 ContentControl（如 Button）编写自定义模板时，你需要在模板中放置一个 ContentPresenter 来告诉 WPF：“在这里显示 ContentControl 的内容”。 
### 使用方式

ContentControl 是你在 XAML 中直接实例化的控件。
```xaml
<ContentControl Content="Hello, World!" />

<!-- 或者更复杂的 -->
<ContentControl>
<StackPanel>
<TextBlock Text="Title" />
<Image Source="logo.png" />
</StackPanel>
</ContentControl>
```
ContentPresenter 几乎总是在 ControlTemplate 中使用，而不是在常规的 UI 布局中。
```xaml

<Style TargetType="ContentControl">
<Setter Property="Template">
<Setter.Value>
<ControlTemplate TargetType="ContentControl">
<Border Background="LightBlue" BorderBrush="Black" BorderThickness="1">
<!-- ContentPresenter 在这里负责显示 ContentControl.Content -->
<ContentPresenter
Content="{TemplateBinding Content}"
ContentTemplate="{TemplateBinding ContentTemplate}" />
</Border>
</ControlTemplate>
</Setter.Value>
</Setter>
</Style>
```
在上面的例子中，ContentPresenter 位于 ContentControl 的模板内，它从 ContentControl 绑定 Content 和 ContentTemplate，然后负责渲染出最终的 UI。 
### 关键区别总结
| 特性             | ContentControl                              | ContentPresenter                             |
|------------------|---------------------------------------------|----------------------------------------------|
| 类型             | 控件 (Control)                              | 布局元素 (FrameworkElement)                  |
| 主要职责         | 管理内容数据 (`Content`) 和模板 (`ContentTemplate`) | 在视觉树中呈现由 `ContentControl` 提供的内容 |
| 使用位置         | XAML 中的主 UI 布局                         | `ContentControl` 的 `ControlTemplate` 内部   |
| 是否可直接使用   | 是，可以直接在窗口或页面中放置              | 通常不是，除非在模板中                       |
| 继承关系         | `Control` → `ContentControl`                | `FrameworkElement` → `ContentPresenter`      |
| 核心属性         | `Content`, `ContentTemplate`, `ContentTemplateSelector` | `Content`, `ContentTemplate`, `ContentTemplateSelector`（用于接收来自父控件的值） |
形象比喻


可以把 ContentControl 想象成一个电视盒子：
它内部有信号源（Content）、解码方式（ContentTemplate）。
而 ContentPresenter 就像是电视盒子上的屏幕，它的唯一工作就是把电视盒子处理好的信号显示出来。

没有电视盒子（ContentControl），屏幕（ContentPresenter）就没有信号可显示；没有屏幕（ContentPresenter），电视盒子（ContentControl）处理的信号就无法被人看到。
总结

当你需要一个可以包含任意内容的控件时，使用 ContentControl。
当你为 ContentControl 或其子类（如 Button）编写自定义外观（ControlTemplate）时，使用 ContentPresenter 来指定内容应该在哪里以及如何被呈现。

两者协同工作，ContentControl 管理数据和逻辑，ContentPresenter 负责最终的视觉呈现。
